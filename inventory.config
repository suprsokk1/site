# inventory.config file in YAML format
plugin: ansible.builtin.constructed
strict: False
# compose:
#     # var_sum: var1 + var2
#     foo: bar
#     # this variable will only be set if I have a persistent
#     # fact cache enabled (and have non expired facts)
#     # `strict: False` will skip this instead of producing an
#     # error if it is missing facts.
#     # server_type: "ansible_hostname | regex_replace ('(.{6})(.{2}).*', '\\2')"
hosts:
  localhost:
    foo: bar

groups:
  local:
    foo: bar
    # simple name matching
    webservers: inventory_hostname.startswith('web')

    # using ec2 'tags' (assumes aws inventory)
    development: "'devel' in (ec2_tags|list)"

    # using other host properties populated in inventory
    private_only: not (public_dns_name is defined or ip_address is defined)

    # complex group membership
    multi_group: (group_names | intersect(['alpha', 'beta', 'omega'])) | length >= 2

keyed_groups:
    # this creates a group per distro (distro_CentOS,
    # distro_Debian) and assigns the hosts that have
    # matching values to it, using the default separator "_"
    - prefix: distro
      key: ansible_distribution

    # the following examples assume the first inventory is
    # from the `aws_ec2` plugin this creates a group per ec2
    # architecture and assign hosts to the matching ones
    # (arch_x86_64, arch_sparc, etc)
    - prefix: arch
      key: architecture

    # this creates a group per ec2 region like "us_west_1"
    - prefix: ""
      separator: ""
      key: placement.region

    # this creates a common parent group for all ec2
    # availability zones
    - key: placement.availability_zone
      parent_group: all_ec2_zones
